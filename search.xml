<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>gateway的使用记录</title>
    <url>/2023/05/07/gateway-de-shi-yong-ji-lu/</url>
    <content><![CDATA[<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><h4 id="添加依赖"><a href="#添加依赖" class="headerlink" title="添加依赖"></a>添加依赖</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;!-- 新版gateway需要加上lb依赖 --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-cloud-starter-loadbalancer&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h4 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h4><ol>
<li>gateway可以添加过滤器，以实现修改请求头，鉴权等功能<code>(实现GlobalFilter接口)</code>，并加入<code>@Component</code>注解,<code>@Order</code>注解设置优先级  </li>
<li>请求路由后 当前路由的过滤器 -&gt; DefaultFilter -&gt; GobalFilter 合并到一个过滤器链,排序后依次执行  </li>
<li>当过滤器的值一样时,会按照defaultFilter -&gt; 路由过滤器 -&gt; GobalFilter的顺序执行</li>
</ol>
<h4 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h4><p>开卷考试</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">spring:</span><br><span class="line">  cloud:</span><br><span class="line">    gateway:</span><br><span class="line">      globalcors: # 全局的跨域处理</span><br><span class="line">        add-to-simple-url-handler-mapping: true # 解决options请求被拦截问题</span><br><span class="line">        corsConfigurations:</span><br><span class="line">          &#x27;[/**]&#x27;:</span><br><span class="line">            allowedOrigins: # 允许哪些网站的跨域请求</span><br><span class="line">              - &quot;http://localhost:8090&quot;</span><br><span class="line">              - &quot;http://www.leyou.com&quot;</span><br><span class="line">            allowedMethods: # 允许的跨域ajax的请求方式</span><br><span class="line">              - &quot;GET&quot;</span><br><span class="line">              - &quot;POST&quot;</span><br><span class="line">              - &quot;DELETE&quot;</span><br><span class="line">              - &quot;PUT&quot;</span><br><span class="line">              - &quot;OPTIONS&quot;</span><br><span class="line">            allowedHeaders: &quot;*&quot; # 允许在请求中携带的头信息</span><br><span class="line">            allowCredentials: true # 是否允许携带cookie</span><br><span class="line">            maxAge: 360000 # 这次跨域检测的有效期</span><br></pre></td></tr></table></figure>

<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>Gateway不是Nginx，他只是分流，没有做代理!!</p>
]]></content>
      <categories>
        <category>spring-cloud</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>gateway</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2023/04/27/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>jackson的简单使用</title>
    <url>/2023/05/06/jackson-de-jian-dan-shi-yong/</url>
    <content><![CDATA[<p>jackson是一款安全的json处理框架<br>大部分都依靠<code>ObjectMapper</code>这个工具类据处理json对象<br>jackson里的json对象分三种<code>JsonNode</code>,<code>ObjectNode</code>和<code>ArrayNode</code><br><code>JsonNode</code>不可更改,<code>ObjectNode</code>是可变的,<code>ArraryNode</code>是列表<br>输出的缩进格式可以更改</p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>jackson</tag>
      </tags>
  </entry>
  <entry>
    <title>nacos使用记录</title>
    <url>/2023/05/06/nacos-shi-yong-ji-lu/</url>
    <content><![CDATA[<h3 id="1-nacos分级存储模型"><a href="#1-nacos分级存储模型" class="headerlink" title="1.nacos分级存储模型"></a>1.nacos分级存储模型</h3><ol>
<li>服务，如userservice</li>
<li>集群，如杭州、上海</li>
<li>实例</li>
</ol>
<h3 id="2-服务发现和服务注册"><a href="#2-服务发现和服务注册" class="headerlink" title="2.服务发现和服务注册"></a>2.服务发现和服务注册</h3><p>添加依赖  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>配置，与eureka类似，也需要配置服务器，还可以配置集群<code>(默认为同一集群)</code>名称</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">spring:</span><br><span class="line">  cloud:</span><br><span class="line">    nacos:</span><br><span class="line">      server-addr: localhost:8848</span><br><span class="line">      discovery:</span><br><span class="line">        cluster-name: DEFAULT ## 集群名称</span><br><span class="line">        namespace:            ## 命名空间</span><br><span class="line">        ephemeral: true       ## 临时实例</span><br></pre></td></tr></table></figure>
<p>或者在启动加入<code>-Dspring.cloud.nacos.discovery.cluster-name=SH</code></p>
<h3 id="3-负载均衡"><a href="#3-负载均衡" class="headerlink" title="3.负载均衡"></a>3.负载均衡</h3><p>新版nacos已经包含ribbon<br>可以使用loadbalancer实现负载均衡</p>
<h3 id="4-配置中心"><a href="#4-配置中心" class="headerlink" title="4.配置中心"></a>4.配置中心</h3><p>添加依赖  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;!-- 对于高版本的springcloud，还需要这个，要不然无法读取bootstrap.yml文件 --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-cloud-starter-bootstrap&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>添加bootstrap.yml文件<br>配置  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: education-service</span><br><span class="line">  profiles:</span><br><span class="line">    active: dev</span><br><span class="line">  cloud:</span><br><span class="line">    nacos:</span><br><span class="line">      server-addr: localhost:8848</span><br><span class="line">      config:</span><br><span class="line">        file-extension: yaml</span><br></pre></td></tr></table></figure>
<h3 id="5-实现热更新"><a href="#5-实现热更新" class="headerlink" title="5.实现热更新"></a>5.实现热更新</h3><p>使用<code>@ConfigurationProperties</code>的属性配置注解注入，自动刷新<br>通过<code>@Value</code>注解注入，结合<code>@RefreshScope</code>注解实现刷新  </p>
<h3 id="6-注意"><a href="#6-注意" class="headerlink" title="6.注意"></a>6.注意</h3><ol>
<li>不是所有的配置都适合放到配置中心，将一些关键参数，需要运行时要调整的参数放到nacos配置中心，一般都是自定义配置</li>
</ol>
]]></content>
      <categories>
        <category>spring-cloud</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>nacos</tag>
      </tags>
  </entry>
  <entry>
    <title>初识docker</title>
    <url>/2023/05/07/chu-shi-docker/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>docker</category>
      </categories>
  </entry>
  <entry>
    <title>麻绳专挑细处断,噩运只找苦命人</title>
    <url>/2023/04/28/ma-sheng-zhuan-tiao-xi-chu-duan-e-yun-zhi-zhao-ku-ming-ren/</url>
    <content><![CDATA[<p>不是说之专挑细处，只是因为麻绳的粗细不同，同样的力道麻绳粗的一段便不会断<br>就厄运而言，实力强大的人他的容错更高<br>因此，我们能做的只有时刻提升自己，以应对可能出现的情况</p>
]]></content>
      <categories>
        <category>随笔</category>
      </categories>
  </entry>
</search>
